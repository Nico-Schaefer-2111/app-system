(this.webpackJsonp=this.webpackJsonp||[]).push([["saas-connect"],{"+C9W":function(t,e,n){"use strict";n.r(e);var a=n("nU+O"),i=n.n(a),s=(n("N6M5"),n("UznR"));e.default={name:"sw-my-apps-page",template:i(),props:{appName:{type:String,required:!0},moduleName:{type:String,required:!0}},data:()=>({appLoaded:!1,timedOut:!1,timedOutTimeout:null}),computed:{currentLocale:()=>Shopware.State.get("session").currentLocale,fallbackLocale:()=>Shopware.Context.app.fallbackLocale,appDefinition(){return Shopware.State.get("connect-apps").apps.find(t=>t.name===this.appName)},moduleDefinition(){return this.appDefinition?this.appDefinition.modules.find(t=>t.name===this.moduleName):null},suspend(){return!this.appDefinition||!this.moduleDefinition},heading(){if(this.suspend)return this.$tc("sw-saas-connect.module.sw-my-apps.general.mainMenuItemGeneral");const t=this.translate(this.appDefinition.label),e=this.translate(this.moduleDefinition.label);return`${t}${t&&e?" - ":""}${e}`},entryPoint(){return this.suspend?null:this.moduleDefinition.source},origin(){if(!this.entryPoint)return null;return new URL(this.entryPoint).origin},innerFrame(){return this.$refs.innerFrame}},watch:{entryPoint(){this.appLoaded=!1,this.timedOut=!1},appLoaded:{immediate:!0,handler(t){clearTimeout(this.timedOutTimeout),this.timedOutTimeout=null,t||(this.timedOutTimeout=setTimeout(()=>{this.appLoaded||(this.timedOut=!0)},5e3))}}},mounted(){window.addEventListener("message",this.onContentLoaded,this.$refs.innerFrame)},beforeDestroy(){window.removeEventListener("message",this.onContentLoaded)},methods:{translate(t){return t[this.currentLocale]||t[this.fallbackLocale]},onContentLoaded(t){t.origin===this.origin&&"connect-app-loaded"===t.data&&(this.appLoaded=!0)}},components:{"sw-my-apps-time-out-animation":s.default}}},"+fQf":function(t,e,n){},"/Bj1":function(t,e){t.exports='{% block sw_connect_action_button %}\n    <component\n        :is="openInNewTab ? \'a\' : \'div\'"\n        class="sw-connect-action-button sw-context-menu-item"\n        :class="{ \'sw-context-menu-item--icon\': !!action.icon }"\n        @click="runAction"\n        v-bind="linkData">\n\n        <img\n            v-if="action.icon"\n            class="sw-connect-action-button__icon"\n            :src="\'data:image/png;base64, \' + action.icon">\n\n        <span class="sw-context-menu-item__text">\n            {{ buttonLabel }}\n            <sw-icon v-if="openInNewTab" name="default-action-external" size="12px"></sw-icon>\n        </span>\n    </component>\n{% endblock %}\n'},"2Z+8":function(t,e,n){var a={"./structure/sw-admin-menu/index.js":"HFdD","./structure/sw-page/index.js":"AvrB"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="2Z+8"},"4KEU":function(t){t.exports=JSON.parse('{"sw-saas-connect":{"component":{},"module":{"sw-my-apps":{"general":{"mainMenuItemGeneral":"My apps","moduleDescription":"Module to show app specific content"}}},"extension":{"component":{}}}}')},"8H+Z":function(t,e,n){},"8ii7":function(t,e,n){"use strict";n.r(e),e.default={namespaced:!0,state:()=>({apps:[]}),getters:{navigation:t=>t.apps.reduce((t,e)=>(t.push(...function(t){const e=Shopware.State.get("session").currentLocale,n=Shopware.Context.app.fallbackLocale,a=t.label[e]||t.label[n];return t.modules.map(i=>{const s=i.label[e]||i.label[n];return{id:`app-${t.name}-${i.name}`,path:"sw.my.apps.index",params:{appName:t.name,moduleName:i.name},label:{translated:!0,label:`${a} - ${s}`},color:"#9AA8B5",parent:"sw-my-apps",children:[]}})}(e)),t),[])},mutations:{setApps(t,e){t.apps=e}},actions:{fetchAppModules:({commit:t})=>Shopware.Service("AppModulesService").fetchAppModules().then(e=>{t("setApps",e)})}}},AtVO:function(t,e,n){var a={"./connect-apps.state":"8ii7"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="AtVO"},AvrB:function(t,e,n){"use strict";n.r(e);var a=n("Ywmq"),i=n.n(a);n("eNFc");const{Mixin:s}=Shopware;e.default={template:i(),name:"sw-page",data:()=>({actions:null}),computed:{appActionButtonService:()=>Shopware.Service("AppActionButtonService"),params(){return this.isListingPage?Object.keys(this.$parent.selection):this.$route.params.id?[this.$route.params.id]:[]},isListingPage(){const t=this.$parent.$options.mixins,e=s.getByName("listing");return!!t&&void 0!==t.find(t=>t===e)},areActionsAvailable(){return!!this.actions&&this.actions.length>0&&this.params.length>0}},watch:{$route:{immediate:!0,async handler(t,e){e?this.didViewChange(t,e)&&(this.actions=await this.getActionButtons(t)):this.actions=await this.getActionButtons(t)}}},methods:{async getActionButtons(t){const e=t.meta.$module;if(!e)return[];const n=e.entity,a=this.getViewForRoute(t);if(!n||!a)return[];try{return this.isLoading=!0,await this.appActionButtonService.getActionButtonsPerView(n,a)}finally{this.isLoading=!1}},runAction(t){this.appActionButtonService.runAction(t,{ids:this.params})},getViewForRoute(t){const e=t.meta.$module;if(e)return Object.keys(e.routes).find(n=>{const a=e.routes[n].name;return t.name.startsWith(a)})},didViewChange(t,e){return(e.meta.$module?e.meta.$module.entity:void 0)!==(t.meta.$module?t.meta.$module.entity:void 0)||this.getViewForRoute(e)!==this.getViewForRoute(t)}}}},HFdD:function(t,e,n){"use strict";n.r(e),e.default={name:"sw-admin-menu",computed:{appEntries:()=>Shopware.State.getters["connect-apps/navigation"]},watch:{appEntries(){this.updateAppEntries()},mainMenuEntries(){this.updateAppEntries()}},methods:{updateAppEntries(){const t=this.mainMenuEntries.findIndex(t=>"sw-my-apps"===t.id);if(t<0)return;const e=this.mainMenuEntries[t],n=this.getNewEntries(e.children,this.appEntries);e.children=[...e.children,...n],this.mainMenuEntries[t]={...e}},getNewEntries:(t,e)=>e.filter(e=>!t.some(t=>t.path===e.path))}}},JsMO:function(t,e,n){"use strict";n.r(e);class a{static get name(){return"AppActionButtonService"}constructor(t,e){this.httpClient=t,this.loginService=e,this.name="AppActionButtonService"}get basicHeaders(){return{"Content-Type":"application/json",Accept:"application/json","sw-language-id":Shopware.Context.api.languageId,Authorization:`Bearer ${this.loginService.getToken()}`}}getActionButtonsPerView(t,e){return this.httpClient.get(`app-system/action-button/${t}/${e}`,{headers:this.basicHeaders}).then(({data:t})=>this.getActionbuttonsFromRequest(t))}getActionbuttonsFromRequest(t){return t&&t.actions?t.actions:[]}runAction(t,e={}){return this.httpClient.post(`app-system/action-button/run/${t}`,e,{headers:this.basicHeaders}).then(({data:t})=>t)}}class i{static get name(){return"AppModulesService"}constructor(t,e){this.httpClient=t,this.loginService=e,this.name="AppModulesService"}get basicHeaders(){return{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${this.loginService.getToken()}`}}fetchAppModules(){return this.httpClient.get("app-system/modules",{headers:this.basicHeaders}).then(({data:t})=>t.modules||[])}}var s=function(t){t.Application.addServiceProvider(a.name,()=>{const e=t.Application.getContainer("init");return new a(e.httpClient,t.Service("loginService"))}),t.Application.addServiceProvider(i.name,()=>{const e=t.Application.getContainer("init");return new i(e.httpClient,t.Service("loginService"))})};var o=function(t){!function(t){const{Component:e}=t,a=n("2Z+8");a.keys().forEach(t=>{const n=a(t).default;e.override(n.name,n,0)})}(t)};function p(){return Shopware.State.dispatch("connect-apps/fetchAppModules")}var r=n("Vl5I");({install:function(t){s(t),function(t){const{State:e}=t;["connect-apps"].forEach(t=>{const a=n("AtVO")(`./${t}.state`).default;e.registerModule(t,a)})}(t),function(t){t.Locale.extend("de-DE",n("fmHS")),t.Locale.extend("en-GB",n("4KEU"))}(t),function(t){const{Component:e}=t,a=n("szPw");a.keys().forEach(t=>{const n=a(t).default;e.register(n.name,n)})}(t),Object(r.installModules)(t),o(t),p()}}).install(Shopware)},N6M5:function(t,e,n){var a=n("pVXX");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("SZ7m").default)("6e044345",a,!0,{})},UznR:function(t,e,n){"use strict";n.r(e);var a=n("byzA"),i=n.n(a);n("egpt");e.default={name:"sw-my-apps-timeout-animation",template:i()}},Vl5I:function(t,e,n){"use strict";function a(t){const{Module:e,Component:a}=t;["sw-my-apps"].forEach(t=>{const i=n("zLdi")(`./${t}`).default;i.components&&Object.keys(i.components).forEach(t=>{const e=i.components[t];e.extendsFrom?a.extend(t,e.extendsFrom,e):a.register(t,e)}),e.register(i.name,i)})}n.r(e),n.d(e,"installModules",(function(){return a}))},"Yk+R":function(t,e,n){"use strict";n.r(e);var a=n("+C9W");e.default={type:"plugin",name:"sw-my-apps",title:"sw-saas-connect.module.sw-my-apps.general.mainMenuItemGeneral",description:"sw-saas-connect.module.sw-my-apps.general.moduleDescription",icon:"default-view-grid",color:"#9AA8B5",routePrefixPath:"my-apps",components:{"sw-my-apps-page":a.default},routes:{index:{component:"sw-my-apps-page",path:":appName/:moduleName",props:{default(t){const{appName:e,moduleName:n}=t.params;return{appName:e,moduleName:n}}}}},navigation:[{id:"sw-my-apps",label:"sw-saas-connect.module.sw-my-apps.general.mainMenuItemGeneral",icon:"default-view-grid",color:"#9AA8B5",position:100}]}},Ywmq:function(t,e){t.exports='{% block sw_page_smart_bar_content_actions %}\n    {% block sw_page_smart_bar_content_app_actions %}\n        <div class="smart-bar__app_actions" v-if="areActionsAvailable">\n            <sw-context-button class="sw-page__connect-action-buttons">\n                <template slot="button">\n                    <sw-button>\n                        <sw-icon name="small-more" size="16"></sw-icon>\n                    </sw-button>\n                </template>\n\n                <sw-connect-action-button\n                    v-for="action in actions"\n                    :key="action.id"\n                    :action="action"\n                    @run-app-action="runAction">\n                </sw-connect-action-button>\n            </sw-context-button>\n        </div>\n    {% endblock %}\n\n    {% parent() %}\n{% endblock %}\n'},byzA:function(t,e){t.exports='<div class="sw-my-apps-timeout-animation">\n    Loading your app resulted in a timeout\n</div>'},eNFc:function(t,e,n){var a=n("xctS");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("SZ7m").default)("0c640da0",a,!0,{})},egpt:function(t,e,n){var a=n("8H+Z");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("SZ7m").default)("3df46c4b",a,!0,{})},fmHS:function(t){t.exports=JSON.parse('{"sw-saas-connect":{"component":{},"module":{"sw-my-apps":{"general":{"mainMenuItemGeneral":"Meine Apps","moduleDescription":"Modul zum Anzeigen appspezifischer Inhalte"}}},"extension":{"component":{}}}}')},ke9y:function(t,e,n){"use strict";n.r(e);var a=n("/Bj1"),i=n.n(a);n("rlX4");e.default={template:i(),name:"sw-connect-action-button",props:{action:{type:Object,required:!0}},computed:{buttonLabel(){const t=Shopware.State.get("session").currentLocale,e=Shopware.Context.app.fallbackLocale;return this.action.label[t]||this.action.label[e]||""},openInNewTab(){return!!this.action.openNewTab},linkData(){return this.openInNewTab?{target:"_blank",href:this.action.url}:{}}},methods:{runAction(){this.openInNewTab||this.$emit("run-app-action",this.action.id)}}}},"nU+O":function(t,e){t.exports='<sw-page class="sw-my-apps-page">\n    <template #smart-bar-header>\n        <h2>{{ heading }}</h2>\n    </template>\n\n    <template #content>\n        <template v-if="!suspend">\n            <iframe\n                id="app-content"\n                class="sw-my-apps-page__app-content"\n                ref="innerFrame"\n                referrerpolicy="origin-when-cross-origin"\n                :src="entryPoint"\n                :title="heading"\n                v-show="appLoaded">\n            </iframe>\n            <template v-if="!appLoaded">\n                <template v-if="timedOut">\n                   <sw-my-apps-time-out-animation></sw-my-apps-time-out-animation>\n                </template>\n                <template v-else>\n                    <sw-loader></sw-loader>\n                </template>\n            </template>\n        </template>\n    </template>\n</sw-page>'},pVXX:function(t,e,n){},rlX4:function(t,e,n){var a=n("+fQf");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,n("SZ7m").default)("71cd5303",a,!0,{})},szPw:function(t,e,n){var a={"./sw-connect-action-button/index.js":"ke9y"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="szPw"},xctS:function(t,e,n){},zLdi:function(t,e,n){var a={"./":"Vl5I","./index":"Vl5I","./index.js":"Vl5I","./sw-my-apps":"Yk+R","./sw-my-apps/":"Yk+R","./sw-my-apps/components/sw-my-apps-timeout-animation":"UznR","./sw-my-apps/components/sw-my-apps-timeout-animation/":"UznR","./sw-my-apps/components/sw-my-apps-timeout-animation/index":"UznR","./sw-my-apps/components/sw-my-apps-timeout-animation/index.js":"UznR","./sw-my-apps/components/sw-my-apps-timeout-animation/sw-my-apps-timeout-animation.html":"byzA","./sw-my-apps/components/sw-my-apps-timeout-animation/sw-my-apps-timeout-animation.scss":"egpt","./sw-my-apps/index":"Yk+R","./sw-my-apps/index.js":"Yk+R","./sw-my-apps/page/sw-my-apps-page":"+C9W","./sw-my-apps/page/sw-my-apps-page/":"+C9W","./sw-my-apps/page/sw-my-apps-page/index":"+C9W","./sw-my-apps/page/sw-my-apps-page/index.js":"+C9W","./sw-my-apps/page/sw-my-apps-page/sw-my-apps-page.html":"nU+O","./sw-my-apps/page/sw-my-apps-page/sw-my-apps-page.html.twig":"nU+O","./sw-my-apps/page/sw-my-apps-page/sw-my-apps-page.scss":"N6M5"};function i(t){var e=s(t);return n(e)}function s(t){if(!n.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=s,t.exports=i,i.id="zLdi"}},[["JsMO","runtime","vendors-node"]]]);
